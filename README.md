<!-- START doctoc generated TOC please keep comment here to allow auto update -->
<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->
## ç›®å½• (Table of Contents)

- [Renda Cloud Lab](#renda-cloud-lab)
  - [ç®€ä»‹](#%E7%AE%80%E4%BB%8B)
  - [æ ¸å¿ƒæ¨¡å—è¯´æ˜](#%E6%A0%B8%E5%BF%83%E6%A8%A1%E5%9D%97%E8%AF%B4%E6%98%8E)
  - [ç›®å½•ç»“æ„](#%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84)
  - [é¡¹ç›®ç»“æ„ä¸èŒè´£åˆ†å±‚åŸåˆ™](#%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E8%81%8C%E8%B4%A3%E5%88%86%E5%B1%82%E5%8E%9F%E5%88%99)
    - [Terraform ä»…è´Ÿè´£ Infra å±‚ï¼ˆé›†ç¾¤åŸºç¡€è®¾æ–½ï¼‰](#terraform-%E4%BB%85%E8%B4%9F%E8%B4%A3-infra-%E5%B1%82%E9%9B%86%E7%BE%A4%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD)
    - [Helm è„šæœ¬è´Ÿè´£éƒ¨ç½²å±‚ï¼ˆK8s åº”ç”¨ä¸æ§åˆ¶å™¨ï¼‰](#helm-%E8%84%9A%E6%9C%AC%E8%B4%9F%E8%B4%A3%E9%83%A8%E7%BD%B2%E5%B1%82k8s-%E5%BA%94%E7%94%A8%E4%B8%8E%E6%8E%A7%E5%88%B6%E5%99%A8)
    - [ç¤ºä¾‹ç»“æ„å»ºè®®ï¼ˆå½“å‰ + åç»­ï¼‰](#%E7%A4%BA%E4%BE%8B%E7%BB%93%E6%9E%84%E5%BB%BA%E8%AE%AE%E5%BD%93%E5%89%8D--%E5%90%8E%E7%BB%AD)
    - [å®è·µæ€»ç»“](#%E5%AE%9E%E8%B7%B5%E6%80%BB%E7%BB%93)
  - [å®‰è£…éƒ¨ç½²æŒ‡å—](#%E5%AE%89%E8%A3%85%E9%83%A8%E7%BD%B2%E6%8C%87%E5%8D%97)
    - [å‰ç½®æ¡ä»¶](#%E5%89%8D%E7%BD%AE%E6%9D%A1%E4%BB%B6)
    - [æœ¬åœ°ç¯å¢ƒæ£€æŸ¥å·¥å…·](#%E6%9C%AC%E5%9C%B0%E7%8E%AF%E5%A2%83%E6%A3%80%E6%9F%A5%E5%B7%A5%E5%85%B7)
    - [åŸºç¡€è®¾æ–½éƒ¨ç½²](#%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD%E9%83%A8%E7%BD%B2)
    - [é¦–æ¬¡åˆ›å»º Spot Interruption SNS Topic](#%E9%A6%96%E6%AC%A1%E5%88%9B%E5%BB%BA-spot-interruption-sns-topic)
    - [é›†ç¾¤åç½®éƒ¨ç½²](#%E9%9B%86%E7%BE%A4%E5%90%8E%E7%BD%AE%E9%83%A8%E7%BD%B2)
    - [åº”ç”¨éƒ¨ç½²](#%E5%BA%94%E7%94%A8%E9%83%A8%E7%BD%B2)
  - [æ—¥å¸¸å·¥ä½œæµ](#%E6%97%A5%E5%B8%B8%E5%B7%A5%E4%BD%9C%E6%B5%81)
    - [é¢„æ£€æ£€æŸ¥ Preflight](#%E9%A2%84%E6%A3%80%E6%A3%80%E6%9F%A5-preflight)
    - [é›†ç¾¤å¯åœç®¡ç†](#%E9%9B%86%E7%BE%A4%E5%90%AF%E5%81%9C%E7%AE%A1%E7%90%86)
    - [æ¨èå®Œæ•´é‡å»ºæµç¨‹](#%E6%8E%A8%E8%8D%90%E5%AE%8C%E6%95%B4%E9%87%8D%E5%BB%BA%E6%B5%81%E7%A8%8B)
  - [æˆæœ¬æ§åˆ¶è¯´æ˜](#%E6%88%90%E6%9C%AC%E6%8E%A7%E5%88%B6%E8%AF%B4%E6%98%8E)
  - [å¸¸è§é—®é¢˜ (FAQ)](#%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98-faq)
  - [é™„å½•](#%E9%99%84%E5%BD%95)
    - [æ–‡æ¡£](#%E6%96%87%E6%A1%A3)
    - [æ£€æŸ¥æ¸…å•](#%E6%A3%80%E6%9F%A5%E6%B8%85%E5%8D%95)
    - [è„šæœ¬æ¸…å•](#%E8%84%9A%E6%9C%AC%E6%B8%85%E5%8D%95)
  - [æœªæ¥è®¡åˆ’](#%E6%9C%AA%E6%9D%A5%E8%AE%A1%E5%88%92)
  - [ğŸ¤ è´¡çŒ®æŒ‡å—](#-%E8%B4%A1%E7%8C%AE%E6%8C%87%E5%8D%97)
  - [ğŸ” License](#-license)
  - [ğŸ“¬ è”ç³»æ–¹å¼](#-%E8%81%94%E7%B3%BB%E6%96%B9%E5%BC%8F)

<!-- END doctoc generated TOC please keep comment here to allow auto update -->

# Renda Cloud Lab

- **æœ€åæ›´æ–°**: August 17, 2025, 07:52 (UTC+08:00)
- **ä½œè€…**: å¼ äººå¤§ï¼ˆRenda Zhangï¼‰

> *ä¸“æ³¨äºäº‘è®¡ç®—æŠ€æœ¯ç ”ç©¶ä¸å¼€å‘çš„å¼€æºå®éªŒå®¤ï¼Œæä¾›é«˜æ•ˆã€çµæ´»çš„äº‘æœåŠ¡è§£å†³æ–¹æ¡ˆï¼Œæ”¯æŒå¤šåœºæ™¯åº”ç”¨ã€‚*

<p align="center">
  <img src="https://img.shields.io/badge/AWS-EKS%20%7C%20Terraform%20%7C%20Helm-232F3E?logo=amazonaws&logoColor=white" />
  <img src="https://img.shields.io/badge/License-MIT-blue.svg" />
  <img src="https://img.shields.io/badge/Status-Active-brightgreen" />
</p>

---

## ç®€ä»‹

**Renda Cloud Lab** é¡¹ç›®æ¶µç›– **AWS äº‘æœåŠ¡ã€EKSã€GitOpsã€å¯è§‚æµ‹æ€§ã€SRE ä»¥åŠ AI Sidecar** ç­‰å‰æ²¿ä¸»é¢˜ã€‚

é€šè¿‡è¯¥å®éªŒå®¤ï¼Œå¼€å‘è€…å¯ä»¥å®è·µåŸºç¡€è®¾æ–½å³ä»£ç ã€å®¹å™¨ç¼–æ’ã€æŒç»­äº¤ä»˜ã€æ··æ²Œå·¥ç¨‹å’Œ AI å·¥ä½œè´Ÿè½½é›†æˆç­‰æŠ€æœ¯åœºæ™¯ã€‚

---

## æ ¸å¿ƒæ¨¡å—è¯´æ˜

æœ¬é¡¹ç›®å›´ç»•äº‘åŸç”Ÿé¢†åŸŸçš„å¤šä¸ªæ ¸å¿ƒæ¨¡å—å±•å¼€ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºï¼š

- **IaC (Infrastructure as Code)** â€” ä½¿ç”¨ `Terraform` ç®¡ç† AWS åŸºç¡€è®¾æ–½ï¼Œæ¢ç´¢ `Pulumi` ç­‰å¤šç§ IaC å®è·µã€‚
- **å®¹å™¨ & ç¼–æ’** â€” åŸºäº `Docker` å®¹å™¨ã€`Kubernetes` (æ‰˜ç®¡äº EKS) è¿›è¡Œåº”ç”¨éƒ¨ç½²ï¼Œåˆ©ç”¨ Karpenter å®ç°å¼¹æ€§ä¼¸ç¼©
- **CI/CD & GitOps** â€” é›†æˆ `AWS CodePipeline` æŒç»­é›†æˆæµæ°´çº¿ï¼Œç»“åˆ `Argo CD` ä¸ `Helm` å®ç° `GitOps` æŒç»­éƒ¨ç½²
- **å¯è§‚æµ‹æ€§ & SRE** â€” å¼•å…¥ `OpenTelemetry`ã€`Prometheus`ã€`Grafana` æ„å»ºå¯è§‚æµ‹ä½“ç³»ï¼Œå¹¶é€šè¿‡ `Chaos Mesh` è½å® `Chaos Engineering`ï¼ˆæ··æ²Œå·¥ç¨‹ï¼‰å®è·µ
- **ç”Ÿæˆå¼ AI Sidecar** â€” åŸºäº `Spring Boot + Spring AI` æ¡†æ¶ï¼Œé›†æˆ AWS Bedrock (å¦‚ Titan å¤§æ¨¡å‹) / GCP Vertex AI ç­‰ç”Ÿæˆå¼ AI æœåŠ¡ï¼Œå®ç°åº”ç”¨æ™ºèƒ½åŒ–
- **æˆæœ¬ & å®‰å…¨æŠ¤æ ** â€” åˆ©ç”¨ Spot å®ä¾‹ã€IRSAã€AWS Budgets æ§åˆ¶æˆæœ¬ï¼Œå¹¶é€šè¿‡ Trivy é•œåƒæ‰«æã€OPA Gatekeeper ç­–ç•¥ç­‰ä¿éšœé›†ç¾¤å®‰å…¨
- **è‡ªåŠ¨æ‰©ç¼©å®¹ (Cluster Autoscaler)** â€” é€šè¿‡è„šæœ¬å¼ `Helm` å®‰è£… `cluster-autoscaler`ï¼Œå®ç°èŠ‚ç‚¹æ•°é‡æ ¹æ®è´Ÿè½½å¼¹æ€§ä¼¸ç¼©
- **è´Ÿè½½å‡è¡¡æ§åˆ¶å™¨ (AWS Load Balancer Controller)** â€” Terraform é¢„ç½® IRSA ä¸ ServiceAccountï¼ŒHelm å®‰è£…åå³å¯ç®¡ç† ALB Ingress

ä¸Šè¿°æ¨¡å—ç›¸äº’åä½œï¼Œæ„æˆäº†ä¸€ä¸ªå®Œæ•´çš„äº‘åŸç”Ÿå®éªŒç¯å¢ƒã€‚

---

## ç›®å½•ç»“æ„

```text
â”œâ”€ infra/                # IaC æ¨¡å—ä¸ç¯å¢ƒå®šä¹‰
â”‚  â”œâ”€ aws/               # Terraform é…ç½®ï¼ˆbackend / providers / vars ç­‰ï¼‰
â”‚  â””â”€ eksctl/            # eksctl YAML (legacy - optional)
â”œâ”€ docs/                 # è®¾è®¡ä¸æµç¨‹æ–‡æ¡£ï¼ˆå¦‚ lifecycle.mdï¼‰
â”œâ”€ charts/               # Helm Chartsï¼ˆæŒ‰åŠŸèƒ½æ‹†åˆ†çš„åº”ç”¨å’Œç³»ç»Ÿç»„ä»¶ï¼‰
â”œâ”€ scripts/              # åŸºç¡€è®¾æ–½å¯åœä¸è‡ªåŠ¨åŒ–è„šæœ¬ï¼ˆå¦‚ä¸€é”®éƒ¨ç½²ã€èŠ‚ç‚¹ä¼¸ç¼©ã€æ¸…ç†ç­‰ï¼‰
â”‚  â””â”€ logs/              # æ‰§è¡Œæ—¥å¿—è¾“å‡ºç›®å½•ï¼ˆå·²åœ¨ .gitignore ä¸­æ’é™¤ï¼‰
â”œâ”€ diagrams/             # æ¶æ„å›¾è¡¨ï¼ˆTerraform graph å¯è§†åŒ–å›¾ï¼‰
â”‚  â”œâ”€ *architecture.dot  # Terraform graph åŸå§‹è¾“å‡º
â”‚  â”œâ”€ *architecture.svg  # SVG æ¶æ„å›¾ï¼ˆæ¨èï¼‰
â”‚  â”œâ”€ *architecture.png  # PNG å¿«é€Ÿé¢„è§ˆå›¾
â”‚  â””â”€ *architecture.md   # å›¾è¡¨ç”Ÿæˆä¸è§£è¯»æŒ‡å—
â””â”€ README.md
```

| ç›®å½•                     | è¯´æ˜                                                                                 |
| ---------------------- | ---------------------------------------------------------------------------------- |
| **infra/aws/**         | Terraform æ¨¡å—ï¼ˆVPCã€å­ç½‘ã€NATã€ALBã€EKS ç­‰ï¼‰å’Œç¯å¢ƒé…ç½®ï¼Œè¿œç«¯çŠ¶æ€ä¿å­˜åœ¨ S3/DynamoDBï¼ˆé»˜è®¤ Region=`us-east-1`ï¼‰ |
| **infra/eksctl/**      | eksctl é…ç½®ï¼ˆLegacyï¼Œå¯é€‰ï¼Œ`create_eks=false` æ—¶ä½¿ç”¨ï¼‰ |
| **docs/**              | ç”Ÿå‘½å‘¨æœŸä¸æµç¨‹è¯´æ˜æ–‡æ¡£ï¼Œä¾‹å¦‚ `docs/lifecycle.md`ï¼ˆä¸€é”®é‡å»ºã€Spot ç»‘å®šã€æ¸…ç†æŒ‡ä»¤ç­‰ï¼‰                             |
| **charts/**            | åº”ç”¨å’Œç³»ç»Ÿçš„ Helm Chartï¼Œéµå¾ª OCI åˆ¶å“è§„èŒƒï¼Œä¾¿äºå¤ç”¨ä¸æ‰©å±•                                              |
| **scripts/**           | è„šæœ¬ï¼šå¦‚ `preflight.sh`ï¼ˆé¢„æ£€æ£€æŸ¥ï¼‰ã€`tf-import.sh`ï¼ˆTerraform å¯¼å…¥ï¼‰ ç­‰                           |
| **diagrams/**          | ç³»ç»Ÿæ¶æ„å’Œæµé‡æ‹“æ‰‘å›¾ï¼Œå¸®åŠ©ç†è§£åŸºç¡€è®¾æ–½ä¸åº”ç”¨å…³ç³»                                                           |
| **.github/workflows/** | GitHub Actions é…ç½®ï¼Œç”¨äº CI æµæ°´çº¿ï¼ˆæ ¼å¼æ£€æŸ¥ã€Terraform Plan ç­‰ï¼‰                                 |

---

## é¡¹ç›®ç»“æ„ä¸èŒè´£åˆ†å±‚åŸåˆ™

> Infra vs Deploy

æœ¬é¡¹ç›®éµå¾ªäº‘åŸç”ŸåŸºç¡€è®¾æ–½ç®¡ç†çš„æ ‡å‡†åˆ†å±‚è®¾è®¡ï¼Œ**æ˜ç¡®å°†é›†ç¾¤èµ„æºçš„åˆ›å»ºä¸ Kubernetes æœåŠ¡çš„éƒ¨ç½²è¿›è¡Œè§£è€¦**ï¼Œä»¥æå‡å¯ç»´æŠ¤æ€§ã€è°ƒè¯•æ•ˆç‡ä¸åæœŸæ‰©å±•èƒ½åŠ›ã€‚

### Terraform ä»…è´Ÿè´£ Infra å±‚ï¼ˆé›†ç¾¤åŸºç¡€è®¾æ–½ï¼‰

Terraform æ‰€ç®¡ç†çš„å†…å®¹åŒ…æ‹¬ä½†ä¸é™äºï¼š

- VPCã€å­ç½‘ã€NAT ç½‘å…³ã€è·¯ç”±è¡¨ç­‰ç½‘ç»œèµ„æºï¼›
- EKS é›†ç¾¤ä¸æ‰˜ç®¡ Node Groupï¼›
- IAM è§’è‰²ä¸ IRSAï¼ˆåŒ…æ‹¬ Cluster Autoscaler æ‰€éœ€çš„è§’è‰²ï¼‰ï¼›
- å®‰å…¨ç»„è§„åˆ™ã€æœåŠ¡é…é¢ä¸ç›¸å…³ä¾èµ–ã€‚

Terraform ç›®æ ‡ï¼š**çº¯å£°æ˜å¼ Infraã€å¹‚ç­‰ã€ç¨³å®šã€æ˜“é‡å»ºã€é€‚åˆæ¯æ—¥é‡å»ºæµ‹è¯•ç¯å¢ƒä½¿ç”¨ã€‚**

### Helm è„šæœ¬è´Ÿè´£éƒ¨ç½²å±‚ï¼ˆK8s åº”ç”¨ä¸æ§åˆ¶å™¨ï¼‰

æ‰€æœ‰ Kubernetes å±‚çš„åº”ç”¨éƒ¨ç½²ï¼ˆåŒ…æ‹¬ä½†ä¸é™äº `cluster-autoscaler`ã€`metrics-server`ã€åç»­å¾®æœåŠ¡ï¼‰ï¼Œå‡ç”±è„šæœ¬ + Helm å®Œæˆï¼Œç¡®ä¿éƒ¨ç½²é¡ºåºæ¸…æ™°ã€è°ƒè¯•çµæ´»ï¼Œé¿å… Terraform çŠ¶æ€æ±¡æŸ“ã€‚

- Helm Chart ç®¡ç† Kubernetes åŸç”Ÿæ§åˆ¶å™¨ï¼›
- æ¯æ¬¡é‡å»ºååˆ·æ–° kubeconfig å¹¶ç»Ÿä¸€éƒ¨ç½²æ‰€æœ‰æ§åˆ¶å™¨ï¼›
- æ¯ä¸ªå¾®æœåŠ¡éƒ½å¯ä»¥æ‹¥æœ‰ç‹¬ç«‹ Chart å’Œ `values.yaml`ï¼ŒåæœŸå¯åˆ‡æ¢è‡³ Helmfile æˆ– ArgoCDã€‚

è„šæœ¬ç¤ºä¾‹ï¼šè§ [`scripts/post-recreate.sh`](./scripts/post-recreate.sh)

### ç¤ºä¾‹ç»“æ„å»ºè®®ï¼ˆå½“å‰ + åç»­ï¼‰

```text
infra/
â”œâ”€â”€ terraform/              # ç®¡ç†é›†ç¾¤ Infraï¼ˆVPC/EKS/IAM/NodeGroupï¼‰
scripts/
â”œâ”€â”€ post-recreate.sh        # é›†ç¾¤åˆ›å»ºåï¼Œåˆ·æ–° kubeconfigï¼Œå®‰è£… ALB Controller/Autoscaler/metrics-server/HPAï¼Œå¹¶éƒ¨ç½²æ ¸å¿ƒæœåŠ¡ä¸ Ingress
â”œâ”€â”€ post-teardown.sh        # å®Œå…¨é”€æ¯åæ¸…ç†æ—¥å¿—ç»„å¹¶ç¡®è®¤èµ„æºåˆ é™¤
â”œâ”€â”€ deploy-service-a.sh     # éƒ¨ç½²ä¸šåŠ¡å¾®æœåŠ¡ Aï¼ˆè®¡åˆ’ä¸­ï¼‰
helm-charts/
â”œâ”€â”€ cluster-autoscaler/
â”œâ”€â”€ service-a/
docs/
â”œâ”€â”€ lifecycle.md
â”œâ”€â”€ troubleshooting-guide.md
```

### å®è·µæ€»ç»“

> Terraform ç®¡æ§èµ„æºè¾¹ç•Œï¼›Helm ä¸è„šæœ¬éƒ¨ç½²å·¥ä½œè´Ÿè½½ã€‚
> ä¸¤è€…èŒè´£æ¸…æ™°ï¼Œäº’ä¸è€¦åˆï¼Œæ˜¯ç°ä»£äº‘åŸç”Ÿå›¢é˜Ÿé€šç”¨çš„ Infra / App Layer åˆ†ç¦»æ¨¡å¼ã€‚

---

## å®‰è£…éƒ¨ç½²æŒ‡å—

ä»¥ä¸‹æŒ‡å—å°†å¸®åŠ©ä½ åœ¨è‡ªå·±çš„ AWS è´¦æˆ·ä¸­éƒ¨ç½²æœ¬å®éªŒç¯å¢ƒï¼ŒåŒ…æ‹¬åŸºç¡€è®¾æ–½å’Œç¤ºä¾‹åº”ç”¨çš„éƒ¨ç½²æ­¥éª¤ã€‚

### å‰ç½®æ¡ä»¶

åœ¨å¼€å§‹éƒ¨ç½²ä¹‹å‰ï¼Œè¯·ç¡®ä¿æ»¡è¶³ä»¥ä¸‹å‰ç½®æ¡ä»¶ï¼ˆå®Œæ•´æ­¥éª¤å‚è§ ğŸ“„ [å‰ç½®æ¡ä»¶æ“ä½œæŒ‡å—](https://github.com/RendaZhang/renda-cloud-lab/blob/master/docs/PREREQUISITES_GUIDE.md#%E5%89%8D%E7%BD%AE%E6%9D%A1%E4%BB%B6%E6%93%8D%E4%BD%9C%E6%8C%87%E5%8D%97)ï¼‰ï¼š

- **AWS è´¦æˆ·åŠæƒé™**ï¼šæ‹¥æœ‰å¯ç”¨çš„ AWS è´¦æˆ·ï¼Œå¹¶å·²å®‰è£…å¹¶é…ç½® AWS CLIï¼ˆä¾‹å¦‚é€šè¿‡ `aws configure` æˆ– AWS SSO ç™»å½•ï¼‰ã€‚**æœ¬é¡¹ç›®é»˜è®¤ä½¿ç”¨ AWS CLI çš„ SSO Profile åç§° `phase2-sso`ï¼Œé»˜è®¤åŒºåŸŸä¸º `us-east-1`**ï¼Œå¦‚ä¸ä½ çš„é…ç½®ä¸åŒè¯·ç›¸åº”è°ƒæ•´åç»­å‘½ä»¤ã€‚
- **Terraform åç«¯**ï¼šæå‰åˆ›å»ºç”¨äº Terraform çŠ¶æ€å­˜å‚¨çš„ S3 Bucket åŠ DynamoDB é”å®šè¡¨ï¼Œå¹¶åœ¨ `infra/aws/backend.tf` ä¸­ç›¸åº”é…ç½®åç§°ã€‚é»˜è®¤å‡å®š S3 Bucket åä¸º `phase2-tf-state-us-east-1`ï¼ŒDynamoDB è¡¨åä¸º `tf-state-lock`ï¼ˆå¯æ ¹æ®éœ€è¦ä¿®æ”¹ï¼‰ã€‚
- **DNS åŸŸå**ï¼ˆå¯é€‰ï¼‰ï¼šè‹¥å¸Œæœ›ä½¿ç”¨è‡ªå®šä¹‰åŸŸåè®¿é—®é›†ç¾¤æœåŠ¡ï¼Œè¯·åœ¨ Route 53 ä¸­é¢„å…ˆåˆ›å»ºç›¸åº” Hosted Zoneï¼ˆå½“å‰é»˜è®¤ä½¿ç”¨çš„å­åŸŸä¸º `lab.rendazhang.com`ï¼‰ã€‚å°† Terraform é…ç½®ä¸­çš„åŸŸåæ›´æ–°ä¸ºä½ çš„åŸŸåï¼Œä»¥ä¾¿å°† ALB åœ°å€æ˜ å°„åˆ°å›ºå®šåŸŸåã€‚å¦åˆ™ï¼Œå¯å¿½ç•¥ DNS é…ç½®ï¼Œç›´æ¥ä½¿ç”¨è‡ªåŠ¨åˆ†é…çš„ ALB åŸŸåè®¿é—®æœåŠ¡ã€‚
- **æœ¬åœ°ç¯å¢ƒ**ï¼šå®‰è£… Terraform (~1.8+)ã€kubectl ä»¥åŠ Helm ç­‰å¿…è¦çš„å‘½ä»¤è¡Œå·¥å…·ï¼ŒåŒæ—¶å®‰è£… Git å’Œ Make ç­‰åŸºç¡€å·¥å…·ã€‚
- **é¢„æ£€è„šæœ¬**ï¼šå¯è¿è¡Œ `preflight.sh` æ¥æ£€æŸ¥å…³é”® Service Quota é…é¢å’Œç¯å¢ƒä¾èµ–ï¼ˆæœªæ¥å°†æ‰©å±•æ£€æŸ¥ AWS CLI / Terraform / Helm ç­‰å·¥å…·é“¾çš„ç‰ˆæœ¬ä¸çŠ¶æ€ï¼‰ã€‚æ‰§è¡Œ `bash scripts/preflight.sh` æˆ– `make preflight` å¯å¼€å§‹é¢„æ£€ã€‚
- **AWS SSO ç™»å½•**ï¼šåœ¨è¿è¡Œ Terraform æˆ–è„šæœ¬å‰ï¼Œè¯·æ‰§è¡Œ `make aws-login` è·å–ä¸´æ—¶å‡­è¯ã€‚

### æœ¬åœ°ç¯å¢ƒæ£€æŸ¥å·¥å…·

æœ¬é¡¹ç›®æ¨èåœ¨ä»¥ä¸‹ç¯å¢ƒä¸­è¿è¡Œï¼š

| å¹³å°ç±»å‹ | æ˜¯å¦æ”¯æŒ | å®‰è£…æ–¹å¼è¯´æ˜ |
| ------------------------- | ---------- | --------------- |
| macOS (Intel/ARM) | âœ… æ”¯æŒ | Homebrew è‡ªåŠ¨å®‰è£… |
| Windows WSL2 (Ubuntu) | âœ… æ”¯æŒ | apt / curl è‡ªåŠ¨å®‰è£… |
| Ubuntu/Debian Linux | âœ… æ”¯æŒ | apt / curl è‡ªåŠ¨å®‰è£… |
| åŸç”Ÿ Windows CMD/Powershell | âŒ ä¸æ”¯æŒ | è¯·ä½¿ç”¨ WSL è¿è¡Œ |
| Arch/Fedora ç­‰ | âŒ ä¸æ”¯æŒ | éœ€æ‰‹åŠ¨å®‰è£…æ‰€æœ‰å·¥å…· |

æ‰§è¡Œç¯å¢ƒåˆå§‹åŒ–å»ºè®®ï¼š

```bash
make check         # äº¤äº’å¼æ£€æŸ¥å¹¶å®‰è£… CLI å·¥å…·
make check-auto    # è‡ªåŠ¨å®‰è£…å…¨éƒ¨ç¼ºå¤±å·¥å…·ï¼ˆæ— æç¤ºï¼‰
# æ—¥å¿—è¾“å‡ºä½äº scripts/logs/check-tools.log
```

### åŸºç¡€è®¾æ–½éƒ¨ç½²

1. **å…‹éš†ä»“åº“**ï¼šä¸‹è½½ä»£ç åº“åˆ°æœ¬åœ°ç¯å¢ƒã€‚

   ```bash
   git clone https://github.com/RendaZhang/renda-cloud-lab.git
   cd renda-cloud-lab
   ```

2. **åˆå§‹åŒ– Terraform**ï¼šåˆ‡æ¢åˆ°åŸºç¡€è®¾æ–½ç›®å½•å¹¶åˆå§‹åŒ– Terraform åç«¯ã€‚

   ```bash
   cd infra/aws
   terraform init -reconfigure
   terraform plan  # å¯é€‰ï¼šæŸ¥çœ‹å°†åˆ›å»ºçš„èµ„æºè®¡åˆ’
   ```

   ç¡®è®¤æ— è¯¯åæ‰§è¡Œ apply æ¥éƒ¨ç½² VPCã€å­ç½‘ã€NAT ç½‘å…³ã€ALB ç­‰åŸºç¡€ç½‘ç»œèµ„æºï¼š

   ```bash
   terraform apply -auto-approve
   ```

   *æ³¨æ„ï¼šTerraform å°†æ ¹æ® `terraform.tfvars` ä¸­çš„é…ç½®åœ¨æŒ‡å®šåŒºåŸŸåˆ›å»ºèµ„ã€‚è‹¥æœªä¿®æ”¹ï¼Œæœ¬é¡¹ç›®é»˜è®¤ Region ä¸º `us-east-1`ã€‚*

### é¦–æ¬¡åˆ›å»º Spot Interruption SNS Topic

å¦‚éœ€æ¥æ”¶èŠ‚ç‚¹è¢«å›æ”¶å‰ä¸¤åˆ†é’Ÿçš„é€šçŸ¥ï¼Œè¯·åœ¨ç¬¬ä¸€æ¬¡éƒ¨ç½²æ—¶æ‰‹åŠ¨åˆ›å»ºå¹¶è®¢é˜… SNS ä¸»é¢˜ `spot-interruption-topic`ï¼š

```bash
aws sns create-topic --name spot-interruption-topic \
  --profile phase2-sso --region us-east-1 \
  --output text --query 'TopicArn'
export SPOT_TOPIC_ARN=arn:aws:sns:us-east-1:123456789012:spot-interruption-topic
aws sns subscribe --topic-arn $SPOT_TOPIC_ARN \
  --protocol email --notification-endpoint you@example.com \
  --profile phase2-sso --region us-east-1
```

éšåæ‰“å¼€é‚®ç®±ç‚¹å‡» **Confirm** å®Œæˆè®¢é˜…ã€‚

è¯¥ Topic ä»…éœ€åˆ›å»ºä¸€æ¬¡ï¼Œåç»­æ‰§è¡Œ `make post-recreate` ä¼šè‡ªåŠ¨å°†æœ€æ–° NodeGroup çš„ ASG ç»‘å®šåˆ°æ­¤ä¸»é¢˜ã€‚

### é›†ç¾¤åç½®éƒ¨ç½²

åœ¨åŸºç¡€è®¾æ–½åˆ›å»ºå®Œæˆåï¼Œè¿è¡Œ `make post-recreate` ä¼šè‡ªåŠ¨å®Œæˆéƒ¨ç½²å±‚åˆå§‹åŒ–ï¼š

- åˆ·æ–°æœ¬åœ° kubeconfigï¼›
- åº”ç”¨ AWS Load Balancer Controller CRDs å¹¶é€šè¿‡ Helm å®‰è£…/å‡çº§æ§åˆ¶å™¨ï¼›
- é€šè¿‡ Helm å®‰è£…/å‡çº§ Cluster Autoscalerï¼›
- éƒ¨ç½²ç¤ºä¾‹åº”ç”¨ï¼ˆä»¥ **ECR Digest** å›ºå®šé•œåƒï¼‰å¹¶é…ç½® `/actuator/health/{readiness,liveness}` æ¢é’ˆä¸ `cpu/mem` èµ„æºï¼›
- å‘å¸ƒ Ingress è·å–å…¬ç½‘ ALBï¼›
- å®‰è£… `metrics-server`ï¼ˆ`--kubelet-insecure-tls`ï¼‰ï¼›
- å‘å¸ƒ `HPA`ï¼ˆCPU 60%ï¼Œ`min=2/max=10`ï¼Œè‡ªå®šä¹‰ `behavior`ï¼‰ï¼›
- è‡ªåŠ¨æ£€æŸ¥ NAT ç½‘å…³ã€ALBã€EKS æ§åˆ¶é¢åŠèŠ‚ç‚¹ç»„ã€æ—¥å¿—ç»„ç­‰èµ„æºçŠ¶æ€å¹¶ç»‘å®š Spot é€šçŸ¥ã€‚

æ­¤è„šæœ¬å±äº **éƒ¨ç½²å±‚**ï¼Œä¸ Terraform ç®¡ç†çš„ **åŸºç¡€è®¾æ–½å±‚** è§£è€¦ï¼Œä¾¿äºåœ¨ä¸ä¿®æ”¹ Infra çš„æƒ…å†µä¸‹è¿­ä»£é›†ç¾¤å†…ç»„ä»¶ã€‚

### åº”ç”¨éƒ¨ç½²

> æœ¬ä»“åº“ç¤ºä¾‹åº”ç”¨ä¸º **task-apiï¼ˆSpring Boot 3 + Actuatorï¼‰**ã€‚
> é•œåƒå­˜æ”¾åœ¨ **Amazon ECR**ï¼Œæ¸…å•ä½äº `task-api/k8s/base/`ï¼ˆ`ns-sa.yaml`ã€`configmap.yaml`ã€`deploy-svc.yaml`ï¼‰ï¼Œä¸€é”®éƒ¨ç½²è„šæœ¬ä¸º `scripts/post-recreate.sh`ã€‚

**å¿«é€Ÿéƒ¨ç½²ï¼š**

```bash
# é»˜è®¤ä½¿ç”¨ï¼šPROFILE=phase2-sso, REGION=us-east-1, CLUSTER=dev, NS=svc-task, APP=task-api, ECR_REPO=task-api, IMAGE_TAG=0.1.0
bash scripts/post-recreate.sh
```

**å¯è¦†ç›–å‚æ•°ï¼š**

```bash
# ä¾‹å¦‚ä½¿ç”¨ latest æ ‡ç­¾ï¼›æˆ–å›ºå®šæŸä¸ª digest
IMAGE_TAG=latest bash scripts/post-recreate.sh
IMAGE_DIGEST=sha256:... bash scripts/post-recreate.sh
```

**è„šæœ¬åšäº†ä»€ä¹ˆï¼ˆå¹‚ç­‰ & å¯é‡è·‘ï¼‰ï¼š**

1. `aws eks update-kubeconfig` åˆ‡åˆ°ç›®æ ‡é›†ç¾¤
2. åº”ç”¨ AWS Load Balancer Controller CRDsï¼Œå¹¶é€šè¿‡ Helm å®‰è£…/å‡çº§æ§åˆ¶å™¨ï¼ˆç­‰å¾…å°±ç»ªï¼‰
3. é€šè¿‡ Helm å®‰è£…/å‡çº§ `cluster-autoscaler`
4. ä¾æ¬¡ `kubectl apply -f task-api/k8s/base/ns-sa.yaml`ã€`configmap.yaml`ã€`deploy-svc.yaml`
5. ä» ECR è§£æ `IMAGE_TAG` â†’ **digest**ï¼ˆæˆ–ä½¿ç”¨ `IMAGE_DIGEST`ï¼‰ï¼Œ`kubectl set image` æ›´æ–°å¹¶ç­‰å¾… `rollout status`
6. å‘å¸ƒ Ingress ç­‰å¾…å…¬ç½‘ ALB å°±ç»ª
7. å®‰è£… `metrics-server`ï¼ˆ`--kubelet-insecure-tls`ï¼‰å¹¶ç­‰å¾…éƒ¨ç½²å®Œæˆ
8. åº”ç”¨ `HPA`ï¼ˆCPU 60%ï¼Œ`min=2/max=10`ï¼Œå« `behavior`ï¼‰
9. æ‰§è¡Œé›†ç¾¤å†… `/api/hello` ä¸ `/actuator/health` å†’çƒŸæµ‹è¯•

> ç¯å¢ƒé”šç‚¹ï¼š`AWS_REGION=us-east-1`ã€`CLUSTER=dev`ã€`NS=svc-task`ã€`ECR_REPO=task-api`
>
> å½“å‰ ECR ç”Ÿå‘½å‘¨æœŸç­–ç•¥ä»…ä¿ç•™ **1 ä¸ª tag** ä¸ **1 å¤©** æœªæ‰“æ ‡ç­¾é•œåƒï¼Œå›æ»šç©ºé—´æå°ï¼Œå»ºè®®è°ƒæ•´ä¸ºä¿ç•™æœ€è¿‘ 5â€“10 ä¸ª tagã€‚

**éƒ¨ç½²ç»“æœéªŒè¯ï¼š**

```bash
kubectl -n svc-task get deploy,svc
kubectl -n svc-task port-forward svc/task-api 8080:8080
curl -s "http://127.0.0.1:8080/api/hello?name=Renda"
curl -s "http://127.0.0.1:8080/actuator/health"
```

> è¯´æ˜ï¼š`task-api/k8s/base/*.yaml` ä¸­çš„ `metadata.namespace` åº”ä¸ `NS` ä¿æŒä¸€è‡´ï¼ˆé»˜è®¤ `svc-task`ï¼‰ã€‚
>
> Terraform å·²é¢„ç½® `aws-load-balancer-controller` çš„ IRSAï¼›è„šæœ¬å·²å®‰è£… AWS Load Balancer Controllerï¼›è¿½åŠ  `Ingress` å³å¯æš´éœ²å…¬ç½‘å…¥å£ï¼ˆALBï¼‰ã€‚

---

## æ—¥å¸¸å·¥ä½œæµ

### é¢„æ£€æ£€æŸ¥ Preflight

åœ¨é¦–æ¬¡éƒ¨ç½²æˆ–æ¯æ¬¡æ›´æ¢ç»ˆç«¯/ç”µè„‘æ—¶ï¼Œå¯å…ˆæ‰§è¡Œé¢„æ£€è„šæœ¬ï¼š

```bash
# ä¸€é”®é¢„æ£€ç¯å¢ƒå’Œé…é¢
make preflight   # ç­‰åŒäº bash scripts/preflight.sh
```

**è¯¥è„šæœ¬å°†è‡ªåŠ¨æ£€æŸ¥ï¼š**

- å…³é”® AWS Service Quota é…é¢ä¸Šé™åŠå½“å‰ä½¿ç”¨é‡ï¼ˆå¦‚ ENI æ•°é‡ã€ALB æ•°é‡ã€vCPU é…é¢ç­‰ï¼‰ï¼Œå¹¶è®¡ç®—å‰©ä½™é¢åº¦
- å°†ç»“æœè¾“å‡ºåˆ°ç»ˆç«¯å¹¶å†™å…¥ `preflight.txt` ä»¥ä¾›å­˜æ¡£å‚è€ƒ

å¤‡æ³¨ï¼š

- æœªæ¥ç‰ˆæœ¬è®¡åˆ’å¢åŠ å¯¹æœ¬åœ°å·¥å…·é“¾ç‰ˆæœ¬ (AWS CLI / Terraform / Helm) çš„æ£€æŸ¥ï¼Œä»¥åŠ AWS SSO ç™»å½•æœ‰æ•ˆæ€§çš„éªŒè¯ã€‚
- å¦‚æœæŸé¡¹é…é¢çš„ä½¿ç”¨é‡æ¥è¿‘ä¸Šé™ï¼Œè„šæœ¬ä¼šä»¥æ˜¾çœ¼é¢œè‰²æ ‡è®°å¹¶é™„ä¸Šç”³è¯·æå‡é…é¢çš„ AWS æ§åˆ¶å°é“¾æ¥ã€‚
- è‹¥æ£€æµ‹åˆ°æœ¬åœ°ç¼ºå°‘å¿…è¦å·¥å…·ï¼Œè„šæœ¬å°†æç¤ºå®‰è£…å‘½ä»¤ï¼ˆbrew / apt / choco ç­‰ï¼‰ã€‚
- Quota æ£€æŸ¥ä¸­å‡ºç° `- used` è¡¨ç¤ºè¯¥é…é¢æ— æ˜“äºç»Ÿè®¡çš„å®æ—¶ä½¿ç”¨é‡ï¼›å‡ºç° `N/A used` åˆ™è¡¨ç¤ºå½“å‰ç”¨é‡ä¸º 0ã€‚

### é›†ç¾¤å¯åœç®¡ç†

åœ¨æ—¥å¸¸ä½¿ç”¨ä¸­ï¼Œå¯é€šè¿‡ Makefile æä¾›çš„å‘½ä»¤å¿«é€Ÿå¯åœé›†ç¾¤çš„å…³é”®èµ„æºï¼Œä»¥èŠ‚çº¦æˆæœ¬å¹¶ä¿æŒç¯å¢ƒå¯æ§ï¼š

- `make start` â€” **å¯åŠ¨åŸºç¡€è®¾æ–½èµ„æº**ï¼šæ‰§è¡Œ Terraform å°† NAT ç½‘å…³ã€ALB ç­‰é«˜æˆæœ¬èµ„æºå¯ç”¨ï¼Œå¹¶ç¡®ä¿ EKS é›†ç¾¤ï¼ˆæ§åˆ¶å¹³é¢åŠèŠ‚ç‚¹ç»„ï¼‰å¤„äºè¿è¡ŒçŠ¶æ€ï¼ˆé›†ç¾¤èµ„æºç°å·²ç”± Terraform ç»Ÿä¸€ç®¡ç†ï¼‰ã€‚é€šå¸¸åœ¨æ¯å¤©å®éªŒå¼€å§‹æ—¶è¿è¡Œï¼Œæ¢å¤ç½‘ç»œå‡ºå£å’Œå¯¹å¤–æœåŠ¡èƒ½åŠ›ã€‚
- `make stop` â€” **åœæ­¢åŸºç¡€è®¾æ–½èµ„æº**ï¼šæ‰§è¡Œ Terraform å…³é—­ NAT ç½‘å…³ã€ALB ç­‰éå¿…è¦èµ„æºï¼Œå¹¶å°† EKS é›†ç¾¤çš„èŠ‚ç‚¹ç»„ (NodeGroup) å®ä¾‹æ•°ç¼©å®¹è‡³ 0ï¼Œä¿ç•™ EKS æ§åˆ¶å¹³é¢å’ŒåŸºç¡€è®¾æ–½çŠ¶æ€ï¼Œä½†æš‚åœå¯¹å¤–ç½‘ç»œè®¿é—®ã€‚é€‚ç”¨äºæ¯æ—¥å®éªŒç»“æŸæ—¶é”€æ¯é«˜æˆæœ¬èµ„æºï¼Œé™ä½æ”¯å‡ºã€‚
- `make stop-hard` â€” **ç¡¬åœç”¨å®Œæ•´ç¯å¢ƒ**ï¼šé€šè¿‡ Terraform åŒæ—¶é”€æ¯ NAT ç½‘å…³ã€ALB ä»¥åŠ EKS æ§åˆ¶å¹³é¢å’ŒèŠ‚ç‚¹ç»„ï¼Œå®ç°å®Œæ•´ç¯å¢ƒçš„å½»åº•åœæ­¢ã€‚ç”¨äºé•¿æ—¶é—´æš‚åœå®éªŒæ—¶çš„å½»åº•å…³åœï¼Œé¿å…æŒç»­äº§ç”Ÿä»»ä½•è´¹ç”¨ï¼ˆé™¤äº†ä¿ç•™çš„ VPC å’ŒçŠ¶æ€å­˜å‚¨ç­‰ï¼‰ã€‚
- `make stop-all` â€” **ç¡¬åœæœºå¹¶æ¸…ç†æ—¥å¿—ç»„ä¸æ£€æŸ¥**ï¼šåœ¨ `stop-hard` çš„åŸºç¡€ä¸Šï¼Œé¢å¤–æ‰§è¡Œ `scripts/post-teardown.sh`ï¼Œåˆ é™¤æ®‹ç•™çš„ EKS CloudWatch Log Groupï¼Œå¹¶éªŒè¯ NAT ç½‘å…³ã€ALBã€EKS é›†ç¾¤åŠ SNS é€šçŸ¥ç­‰èµ„æºå‡å·²æ­£ç¡®ç§»é™¤ï¼Œé¿å…è®¡è´¹ç´¯ç§¯ã€‚
- `make post-recreate` â€” åˆ·æ–°æœ¬åœ° kubeconfig å¹¶ä½¿ç”¨ Helm éƒ¨ç½²ï¼Œä»¥åŠè¿è¡Œ Spot é€šçŸ¥è‡ªåŠ¨ç»‘å®š
- `make start-all` â€” `start` â†’ `post-recreate` ä¸€é”®å…¨æµç¨‹
- `make destroy-all` â€” **âš ï¸ é«˜å±ï¼** å…ˆè¿è¡Œ `make stop-hard`ï¼Œå†æ‰§è¡Œ Terraform é”€æ¯æ‰€æœ‰èµ„æºå¹¶è°ƒç”¨ `post-teardown.sh` æ¸…ç†æ—¥å¿—ç»„å¹¶æ‰§è¡Œåˆ é™¤åæ£€æŸ¥
- `make check` â€” æœ¬åœ°ä¾èµ–å·¥å…·é“¾æ£€æµ‹ï¼ˆaws / terraform / helmï¼‰ï¼Œå¹¶å°†ç»“æœå†™å…¥ `scripts/logs/check-tools.log`
- `make logs` â€” æŸ¥çœ‹ `scripts/logs/` ä¸‹å„ç±»æ—¥å¿—ï¼Œè‡ªåŠ¨å±•ç¤º `post-recreate.log`ã€`preflight.txt`ã€`check-tools.log`
- `make clean` â€” åˆ é™¤ Spot ç»‘å®šç¼“å­˜æ–‡ä»¶å¹¶æ¸…ç©ºæ—¥å¿—ç›®å½•åŠè®¡åˆ’æ–‡ä»¶
- `make update-diagrams` â€” ä¸€é”®ç”Ÿæˆæœ€æ–°çš„ Terraform æ¶æ„å›¾ï¼Œè¾“å‡ºåˆ° `diagrams/` ç›®å½•ä¸­

ä»¥ä¸Šå‘½ä»¤æä¾›äº†ä¸€é”®å¼çš„é›†ç¾¤ç”Ÿå‘½å‘¨æœŸç®¡ç†æ–¹æ¡ˆã€‚

ä½ å¯ä»¥æ ¹æ®éœ€è¦å°†å®ƒä»¬åŠ å…¥å®šæ—¶ä»»åŠ¡ï¼Œå®ç°è‡ªåŠ¨å¯åœï¼ˆè¯¦è§ä¸‹æ–¹æˆæœ¬æ§åˆ¶è¯´æ˜ï¼‰ã€‚

è¯·æ³¨æ„ï¼Œåœ¨é‡æ–°å¯åŠ¨é›†ç¾¤èµ„æºåï¼Œå¯èƒ½éœ€è¦ç­‰å¾…å‡ åˆ†é’Ÿä»¥æ¢å¤æ‰€æœ‰æœåŠ¡ï¼ˆä¾‹å¦‚æ–°å»ºçš„ NAT ç½‘å…³å’Œ ALB å°±ç»ªï¼‰ï¼Œåº”ç”¨æ‰èƒ½é‡æ–°é€šè¿‡åŸŸåè®¿é—®ã€‚

### æ¨èå®Œæ•´é‡å»ºæµç¨‹

```bash
# ä¸€é”®å¯ç”¨ NAT/ALB + åˆ›å»º/å¯¼å…¥é›†ç¾¤ + åˆ·æ–°æœ¬åœ° kubeconfig + ä½¿ç”¨ Helm éƒ¨ç½² + ç»‘å®š Spot é€šçŸ¥ + ä¸€é”®æ¢å¤åº”ç”¨ï¼ˆtask-apiï¼‰
make start-all

# ... coding ...

# å…³é—­é«˜æˆæœ¬èµ„æº
make stop-all
```

æ‰§è¡Œ `make start-all` å®Œæˆé›†ç¾¤é‡å»ºåï¼Œå¯ç”¨ä¸‹åˆ—å‘½ä»¤æ£€æŸ¥æ§åˆ¶é¢æ—¥å¿—å’Œ NodeGroup Spot è®¢é˜…æ˜¯å¦ç”Ÿæ•ˆï¼š

```bash
aws eks describe-cluster --name dev --profile phase2-sso --region us-east-1 --query "cluster.logging.clusterLogging[?enabled].types" --output table

aws logs describe-log-groups --profile phase2-sso --region us-east-1 --log-group-name-prefix "/aws/eks/dev/cluster" --query 'logGroups[].logGroupName' --output text

# è¾“å‡ºåº”åŒ…å« `api`ã€`authenticator` ä»¥åŠ `/aws/eks/dev/cluster`ã€‚
```

éšååœ¨ AWS Console âœ SNS âœ Topics âœ `spot-interruption-topic` ä¸­ç¡®è®¤è®¢é˜…çŠ¶æ€ä¸º *Confirmed*ã€‚

> æç¤ºï¼šECR ä¸éšæ¯æ—¥é”€æ¯è€Œåˆ é™¤ï¼Œå› æ­¤è„šæœ¬å¯ç›´æ¥ä½¿ç”¨å·²æœ‰é•œåƒï¼›è‹¥éœ€è¦æ–°ç‰ˆæœ¬ï¼Œå…ˆåœ¨æœ¬åœ°æ„å»ºå¹¶ `docker push` åˆ° ECRã€‚

## æˆæœ¬æ§åˆ¶è¯´æ˜

äº‘èµ„æºæŒ‰éœ€é«˜æ•ˆåˆ©ç”¨æ˜¯æœ¬é¡¹ç›®çš„é‡è¦è€ƒé‡ã€‚

**Renda Cloud Lab** å®è·µäº†ä¸€å¥—â€œæ¯æ—¥è‡ªåŠ¨é”€æ¯ -> æ¬¡æ—¥é‡å»ºâ€çš„åŸºç¡€è®¾æ–½ç”Ÿå‘½å‘¨æœŸç­–ç•¥ï¼Œä»¥æœ€å¤§åŒ–èŠ‚çº¦ AWS è´¹ç”¨ï¼š

**æ—¥é—´å¯ç”¨ï¼Œå¤œé—´é”€æ¯**ï¼š

é€šè¿‡ Makefile è„šæœ¬åœ¨æ¯å¤©æ—©æ™¨è‡ªåŠ¨éƒ¨ç½²å¿…è¦èµ„æºï¼ˆå¦‚ NAT ç½‘å…³ã€ALBï¼‰ï¼Œå¤œé—´è‡ªåŠ¨é”€æ¯è¿™äº›éå¿…è¦èµ„æºã€‚

æ­¤ç­–ç•¥ç¡®ä¿åœ¨æ´»è·ƒå®éªŒæ—¶æ®µé›†ç¾¤å…·å¤‡å®Œæ•´çš„ç½‘ç»œå‡ºå£å’Œè®¿é—®èƒ½åŠ›ï¼Œè€Œåœ¨é—²ç½®æ—¶æ®µé‡Šæ”¾é«˜æˆæœ¬èµ„æºã€‚

åŸºç¡€è®¾æ–½çš„çŠ¶æ€ï¼ˆå¦‚ VPCã€æ•°æ®å­˜å‚¨å’Œ Terraform çŠ¶æ€ï¼‰ä¼šè¢«ä¿ç•™ï¼Œä»¥ä¾¿ç¬¬äºŒå¤©å¿«é€Ÿé‡å»ºã€‚

å¯¹äºé•¿å‡æˆ–æš‚åœä½¿ç”¨çš„æƒ…å†µï¼Œå¯ä»¥é€‰æ‹©æ‰§è¡Œâ€œç¡¬åœç”¨â€æµç¨‹ï¼Œé”€æ¯ EKS æ§åˆ¶å¹³é¢åŠæ‰€æœ‰èŠ‚ç‚¹ï¼Œä»¥é¿å…æŒç»­è®¡è´¹ã€‚

**å›ºå®šåŸŸå**ï¼š

å€ŸåŠ© Route 53 çš„ Alias Recordï¼Œå°†åŠ¨æ€ç”Ÿæˆçš„è´Ÿè½½å‡è¡¡å™¨ DNS æ˜ å°„åˆ°å›ºå®šåŸŸåï¼ˆé»˜è®¤ä½¿ç”¨ `lab.rendazhang.com`ï¼‰ã€‚

å³ä½¿æ¯å¤©é‡æ–°åˆ›å»º ALBï¼Œå…¶å¯¹å¤–è®¿é—®åœ°å€ä¿æŒä¸å˜ï¼Œç”¨æˆ·å’Œç³»ç»Ÿé›†æˆæ— éœ€æ¯æ—¥æ›´æ–°é…ç½®ã€‚

**å¼¹æ€§æ‰©ç¼©å®¹**ï¼š

é›†ç¾¤å·¥ä½œèŠ‚ç‚¹é‡‡ç”¨æŒ‰éœ€ **Spot å®ä¾‹**ï¼ˆç»“åˆ Karpenter æˆ– Auto Scalingï¼‰ï¼Œæ ¹æ®è´Ÿè½½è‡ªåŠ¨ä¼¸ç¼©ã€‚

åœ¨æ— å·¥ä½œè´Ÿè½½æ—¶å¯å°†èŠ‚ç‚¹æ•°ç¼©è‡³ 0 ä»¥èŠ‚çœå¼€é”€ï¼ˆæä¾›äº† `scripts/scale-nodegroup-zero.sh` è„šæœ¬å¯ä¸€é”®å°†èŠ‚ç‚¹ç»„ç¼©å®¹è‡³ 0ï¼‰ã€‚

æ¢å¤å®éªŒæ—¶ï¼Œåªéœ€é‡æ–°éƒ¨ç½²åº”ç”¨æˆ–äº§ç”Ÿæ–°è´Ÿè½½ï¼ŒèŠ‚ç‚¹ä¾¿ä¼šæŒ‰éœ€å¯åŠ¨ã€‚

**é‡å»ºåè„šæœ¬**ï¼š

`post-recreate.sh` ä¼šåˆ·æ–°æœ¬åœ° kubeconfigï¼Œåº”ç”¨ ALB æ§åˆ¶å™¨ CRDs å¹¶é€šè¿‡ Helm å®‰è£…/å‡çº§ AWS Load Balancer Controllerã€Cluster Autoscalerã€metrics-server ä¸ HPAï¼Œéƒ¨ç½²ç¤ºä¾‹åº”ç”¨å¹¶å‘å¸ƒ Ingressï¼ŒéšåæŠŠæœ€æ–° NodeGroup çš„ ASG è®¢é˜…åˆ° `spot-interruption-topic`ï¼Œç¡®ä¿èŠ‚ç‚¹è¢«å›æ”¶å‰ 2 åˆ†é’Ÿè§¦å‘ SNS â†’ é‚®ä»¶/ChatOpsï¼Œæ–¹ä¾¿é¢„ç•™æ—¶é—´å°†åº”ç”¨æµé‡ç–æ•£æˆ–è§¦å‘è‡ªåŠ¨åŒ–æ“ä½œã€‚

**æˆæœ¬é¢„ç®—æé†’**ï¼š

é€šè¿‡ Terraform åˆ›å»º AWS Budgetsï¼ˆé»˜è®¤ 90 USDï¼‰ï¼Œå½“æ”¯å‡ºè¾¾åˆ°è®¾å®šæ¯”ä¾‹æ—¶ä¼šå‘æŒ‡å®šé‚®ç®±å‘é€è­¦æŠ¥ã€‚

é€šè¿‡ä»¥ä¸Šæªæ–½ï¼Œå®éªŒé›†ç¾¤åœ¨ç¡®ä¿åŠŸèƒ½å®Œæ•´çš„åŒæ—¶ï¼Œå°†æ—¥å¸¸è¿è¡Œæˆæœ¬æ§åˆ¶åœ¨ä½æ°´å¹³ã€‚

å¦‚éœ€äº†è§£æ¯å¤©æ™šä¸Šå…³æœºã€æ—©ä¸Šé‡å»ºçš„å…·ä½“æ“ä½œæ­¥éª¤åŠæ•…éšœæ’æŸ¥ï¼Œè¯·å‚é˜… ğŸ“„ [æ¯æ—¥ EKS é‡å»ºä¸é”€æ¯æ“ä½œæŒ‡å—](https://github.com/RendaZhang/renda-cloud-lab/blob/master/docs/DAILY_REBUILD_TEARDOWN_GUIDE.md#terraform-%E9%87%8D%E5%BB%BA%E4%B8%8E%E9%94%80%E6%AF%81%E6%B5%81%E7%A8%8B%E6%93%8D%E4%BD%9C%E6%96%87%E6%A1%A3)ã€‚

**ç‰ˆæœ¬ä¸å›æ»šå»ºè®®**ï¼š

ç”Ÿäº§/é¢„å‘æ¨è **å›ºå®šé•œåƒ digest**ï¼ˆ`image: ...@sha256:...`ï¼‰ï¼Œé¿å… `:latest` æ¼‚ç§»ï¼›ECR ç”Ÿå‘½å‘¨æœŸç­–ç•¥å»ºè®®è‡³å°‘ä¿ç•™æœ€è¿‘ **5â€“10** ä¸ª tag æˆ–ä¿ç•™ **7 å¤©** çš„ untaggedï¼Œä»¥ä¾¿å¿«é€Ÿå›æ»šã€‚

ä¸‹è¡¨ä¸ºå¯ç”¨æˆæœ¬æ§åˆ¶ç­–ç•¥ä¸‹çš„ä¸»è¦èµ„æºæœˆåº¦è´¹ç”¨ä¼°ç®—ï¼š

| èµ„æº                   | ç­–ç•¥                    | ä¼°ç®—/æœˆ               |
| -------------------- | --------------------- | ------------------ |
| **EKS æ§åˆ¶å¹³é¢**         | æŒ‰éœ€å¯ç”¨ï¼Œé—²ç½®æ—¶æ®µç¼©å®¹æˆ–åˆ é™¤        | çº¦ $20 â€“ $30 USD |
| **å·¥ä½œèŠ‚ç‚¹ (NodeGroup)** | Spot å®ä¾‹ + è‡ªåŠ¨ä¼¸ç¼©ï¼Œæ ¹æ®è´Ÿè½½è°ƒèŠ‚ | éšå®éªŒå¼ºåº¦åŠ¨æ€å˜åŒ–          |
| **ç›‘æ§ä¸ AI è¾…åŠ©ç»„ä»¶**      | è®¾ç½®é‡‡æ ·ç‡ä¸Šé™ã€é¢„ç®—æŠ¥è­¦ç­‰         | å¯æ§åˆ¶åœ¨ çº¦ $20 USD å†… |

> ä¸Šè¿°è´¹ç”¨ä¸ºè¿‘ä¼¼å€¼ï¼Œå®é™…èŠ±è´¹ä¼šå› åŒºåŸŸå’Œä½¿ç”¨æƒ…å†µæœ‰æ‰€ä¸åŒã€‚
> å»ºè®®è®¾ç½® AWS Budgets å¹¶ç»“åˆè‡ªåŠ¨å…³åœç­–ç•¥ï¼ŒåŠæ—¶æé†’å¹¶è§„é¿æ„å¤–è´¦å•ã€‚
> å¦‚æœéœ€è¦é•¿æ—¶é—´è¿ç»­è¿è¡Œé›†ç¾¤ï¼Œå¯æš‚æ—¶åœç”¨ä¸Šè¿°è‡ªåŠ¨é”€æ¯ç­–ç•¥ï¼Œä½†åŠ¡å¿…ç•™æ„ç”±æ­¤äº§ç”Ÿçš„é¢å¤–è´¹ç”¨ã€‚

---

## å¸¸è§é—®é¢˜ (FAQ)

**å¦‚ä½•æ£€æŸ¥æœ¬åœ°å·¥å…·å’Œ AWS é…é¢æ˜¯å¦æ»¡è¶³å®éªŒè¦æ±‚ï¼Ÿ**

- è¿è¡Œ `make preflight`ï¼Œè„šæœ¬ä¼šè‡ªåŠ¨æ£€æŸ¥æœ¬åœ° CLI å·¥å…·ç‰ˆæœ¬ã€AWS SSO ç™»å½•çŠ¶æ€ï¼Œä»¥åŠå…³é”®é…é¢ï¼ˆå¦‚ ENI / vCPU / Spot ä½¿ç”¨æƒ…å†µï¼‰ï¼Œå¹¶ç”ŸæˆæŠ¥å‘Šå¸®åŠ©ä½ è¯„ä¼°å½“å‰ç¯å¢ƒæ˜¯å¦ç¬¦åˆè¦æ±‚ã€‚

**å¦‚ä½•å°†æœ¬é¡¹ç›®éƒ¨ç½²åˆ°æˆ‘çš„ AWS è´¦æˆ·ï¼Ÿéœ€è¦ä¿®æ”¹å“ªäº›é…ç½®ï¼Ÿ**

- é¦–å…ˆè¯·ç¡®ä¿æ»¡è¶³æ–‡æ¡£ä¸­æåˆ°çš„æ‰€æœ‰å‰ç½®æ¡ä»¶ï¼Œç„¶ååœ¨ `infra/aws/terraform.tfvars` ä¸­ä¿®æ”¹å¿…è¦çš„å˜é‡ä»¥åŒ¹é…ä½ çš„ç¯å¢ƒã€‚
- ä¾‹å¦‚ï¼Œå°† `profile` æ›´æ–°ä¸ºä½ çš„ AWS CLI é…ç½®æ–‡ä»¶åï¼Œæä¾›ä½ è‡ªæœ‰çš„ S3 Bucket å’Œ DynamoDB è¡¨ç”¨äº Terraform åç«¯å­˜å‚¨ã€‚
- è‹¥ä½¿ç”¨è‡ªå®šä¹‰åŸŸåï¼Œè¿˜éœ€è¦åœ¨ Terraform é…ç½®ä¸­å°†é»˜è®¤çš„ `lab.rendazhang.com` æ”¹ä¸ºä½ çš„åŸŸåå¹¶æä¾›å¯¹åº”çš„ Hosted Zoneã€‚
- å®Œæˆé…ç½®åï¼ŒæŒ‰ç…§ **å®‰è£…éƒ¨ç½²æŒ‡å—** ä¸­çš„æ­¥éª¤æ‰§è¡Œ Terraform å’Œç›¸å…³è„šæœ¬å³å¯ã€‚
- éƒ¨ç½²è¿‡ç¨‹ä¸­è¯·ç¡®ä¿ AWS å‡­è¯æœ‰æ•ˆä¸”æœ‰è¶³å¤Ÿæƒé™åˆ›å»ºæ‰€éœ€èµ„æºã€‚
- `terraform.tfvars` è¿˜åŒ…å« AWS Budgets ç›¸å…³å˜é‡ï¼Œå¯å°† `create_budget=false` ä»¥å…¼å®¹æ—  Billing æƒé™çš„è´¦å·ã€‚

**æ¯å¤©è‡ªåŠ¨é”€æ¯å’Œé‡å»ºé›†ç¾¤ç¯å¢ƒæ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿå¯ä»¥è‡ªå®šä¹‰è¿™ä¸ªè°ƒåº¦å—ï¼Ÿ**

- æœ¬é¡¹ç›®é€šè¿‡ Makefile è„šæœ¬å’Œ Terraform æ¨¡å—å®ç°èµ„æºçš„æŒ‰æ—¥å¯åœï¼šæ—©æ™¨æ‰§è¡Œ `make start` åˆ›å»º NAT ç½‘å…³ã€ALB ç­‰èµ„æºï¼Œå¤œæ™šæ‰§è¡Œ `make stop` é”€æ¯è¿™äº›èµ„æºå¹¶ä¿ç•™åŸºç¡€è®¾æ–½çŠ¶æ€ã€‚
- ä½ å¯ä»¥åˆ©ç”¨ CI/CD å¹³å°çš„å®šæ—¶ä»»åŠ¡å®ç°å…¨è‡ªåŠ¨è°ƒåº¦ï¼Œä¾‹å¦‚ä½¿ç”¨ GitHub Actions çš„ `cron` å®šæ—¶è§¦å‘ `make start/stop`ï¼Œæˆ–é€šè¿‡ AWS CodePipeline é…åˆ EventBridge å®šæ—¶äº‹ä»¶è§¦å‘ã€‚
- åŒæ ·åœ°ï¼Œä½ ä¹Ÿå¯ä»¥æ ¹æ®éœ€è¦è°ƒæ•´ç­–ç•¥ï¼šä¾‹å¦‚ï¼Œä»…åœ¨å·¥ä½œæ—¥æ‰§è¡Œè‡ªåŠ¨å¯åœï¼Œå‘¨æœ«ä¿æŒå…³é—­ï¼Œç”šè‡³å®Œå…¨åœç”¨è‡ªåŠ¨é”€æ¯ï¼ˆä½†éœ€æ‰¿æ‹…é¢å¤–è´¹ç”¨ï¼‰ã€‚
- è°ƒåº¦çš„çµæ´»æ€§å®Œå…¨å–å†³äºä½ çš„å®éªŒéœ€æ±‚ã€‚

**å¦‚æœæˆ‘å¸Œæœ›é›†ç¾¤é•¿æ—¶é—´è¿ç»­è¿è¡Œï¼Œæ˜¯å¦å¯ä»¥ä¸é”€æ¯èµ„æºï¼Ÿ**

- å¯ä»¥ã€‚
- ä¸Šè¿°è‡ªåŠ¨é”€æ¯ç­–ç•¥ä¸»è¦ç”¨äºèŠ‚çº¦æˆæœ¬ï¼Œä½ å¯ä»¥é€‰æ‹©ä¸æ‰§è¡Œæ¯æ—¥çš„ `make stop`ï¼Œä½¿é›†ç¾¤å’Œç›¸å…³èµ„æºæŒç»­è¿è¡Œã€‚
- ä¸è¿‡è¯·æ³¨æ„ï¼Œé•¿æ—¶é—´è¿è¡Œå°†äº§ç”ŸæŒç»­è´¹ç”¨ï¼ˆç‰¹åˆ«æ˜¯ EKS æ§åˆ¶å¹³é¢å’Œ NAT ç½‘å…³ç­‰å›ºå®šæˆæœ¬ï¼‰ã€‚
- å»ºè®®åœ¨æŒç»­è¿è¡Œæ—¶ä»é‡‡ç”¨å…¶ä»–æˆæœ¬æ§åˆ¶æªæ–½ï¼Œä¾‹å¦‚ç¼©å‡ä¸å¿…è¦çš„èŠ‚ç‚¹ã€ç›‘æ§é¢„ç®—æ¶ˆè€—ç­‰ã€‚
- ä½ ä¹Ÿå¯ä»¥æ”¹ä¸ºæŒ‰éœ€å¯åœçš„æ–¹å¼ï¼Œä¾‹å¦‚åªåœ¨éœ€è¦æ—¶æ‰‹åŠ¨è¿è¡Œè„šæœ¬åˆ›å»º/åˆ é™¤é›†ç¾¤ã€‚
- æ€»ä¹‹ï¼Œæœ¬é¡¹ç›®æä¾›çš„è„šæœ¬å’Œç­–ç•¥æ˜¯å¯é€‰çš„ï¼Œç”¨æˆ·å¯æ ¹æ®å®é™…éœ€æ±‚è°ƒæ•´èµ„æºç”Ÿå‘½å‘¨æœŸç®¡ç†æ–¹å¼ã€‚

**é»˜è®¤æä¾›çš„åŸŸå `lab.rendazhang.com` æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿå¯ä»¥æ›´æ¢å—ï¼Ÿ**

- è¯¥è‡ªå®šä¹‰åŸŸåé€šè¿‡ Route 53 Alias è®°å½•å›ºå®šè§£æåˆ°å®éªŒé›†ç¾¤çš„ ALBï¼Œä½œç”¨æ˜¯åœ¨é‡å»ºé›†ç¾¤æ—¶ä¿æŒå¯¹å¤–è®¿é—®åœ°å€ä¸å˜ã€‚
- å¦‚æœä½  Fork æœ¬é¡¹ç›®æˆ–åœ¨è‡ªå·±çš„è´¦æˆ·ä¸­éƒ¨ç½²ï¼Œé€šå¸¸æ— æ³•ä½¿ç”¨ `lab.rendazhang.com` åŸŸåã€‚
- æ­¤æ—¶ä½ å¯ä»¥**æ›´æ¢ä¸ºè‡ªå·±çš„åŸŸå**ï¼šæ–¹æ³•æ˜¯åœ¨ä½ çš„ Route 53 ä¸­åˆ›å»ºå¯¹åº”åŸŸåçš„ Hosted Zoneï¼Œå¹¶åœ¨ Terraform é…ç½®ä¸­å°† `lab.rendazhang.com` ä¿®æ”¹ä¸ºä½ çš„åŸŸåï¼ˆæˆ–å¦‚æœä¸æƒ³ä½¿ç”¨è‡ªå®šä¹‰åŸŸåï¼Œä¹Ÿå¯åˆ é™¤ Terraform ä¸­ `aws_route53_record` èµ„æºç›´æ¥ä½¿ç”¨ ALB é»˜è®¤åŸŸåï¼‰ã€‚
- æ›´æ¢åŸŸååï¼Œéœ€è¦åœ¨è®¿é—®åº”ç”¨æ—¶ä½¿ç”¨æ–°çš„åŸŸåã€‚
- å¦‚æœä¸è®¾ç½®è‡ªå®šä¹‰åŸŸåï¼Œåˆ™å¯ç›´æ¥ä½¿ç”¨ AWS ALB è‡ªåŠ¨åˆ†é…çš„åŸŸåæ¥è®¿é—®æœåŠ¡ã€‚

---

## é™„å½•

### æ–‡æ¡£

- ğŸ“„ [EKS äº‘åŸç”Ÿé›†ç¾¤ç”Ÿå‘½å‘¨æœŸæµç¨‹](https://github.com/RendaZhang/renda-cloud-lab/blob/master/docs/EKS_CLUSTER_LIFECYCLE_GUIDE.md#eks-%E4%BA%91%E5%8E%9F%E7%94%9F%E9%9B%86%E7%BE%A4%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E6%B5%81%E7%A8%8B%E6%96%87%E6%A1%A3)
- ğŸ“„ [æ¯æ—¥ Terraform é‡å»ºä¸é”€æ¯æµç¨‹æ“ä½œæ–‡æ¡£](https://github.com/RendaZhang/renda-cloud-lab/blob/master/docs/DAILY_REBUILD_TEARDOWN_GUIDE.md#terraform-%E9%87%8D%E5%BB%BA%E4%B8%8E%E9%94%80%E6%AF%81%E6%B5%81%E7%A8%8B%E6%93%8D%E4%BD%9C%E6%96%87%E6%A1%A3)
- ğŸ“„ [é›†ç¾¤æ•…éšœæ’æŸ¥æŒ‡å—](https://github.com/RendaZhang/renda-cloud-lab/blob/master/docs/TROUBLESHOOTING.md#%E9%9B%86%E7%BE%A4%E6%95%85%E9%9A%9C%E6%8E%92%E6%9F%A5%E6%8C%87%E5%8D%97)
- ğŸ“„ [AGENTS æ™ºèƒ½ä½“æ“ä½œæŒ‡å—](https://github.com/RendaZhang/renda-cloud-lab/blob/master/docs/AGENTS.md#guidance-for-ai-agents)
- ğŸ“„ [eksctl é—ç•™æŒ‡å¼•](https://github.com/RendaZhang/renda-cloud-lab/blob/master/docs/LEGACY_EKSCTL.md#eksctl-%E6%8C%87%E5%BC%95)
- ğŸ“„ [å‰ç½®æ¡ä»¶æ“ä½œæŒ‡å—](https://github.com/RendaZhang/renda-cloud-lab/blob/master/docs/PREREQUISITES_GUIDE.md#%E5%89%8D%E7%BD%AE%E6%9D%A1%E4%BB%B6%E6%93%8D%E4%BD%9C%E6%8C%87%E5%8D%97)


### æ£€æŸ¥æ¸…å•

- æ£€æŸ¥ Terraform ç‰ˆæœ¬ â‰¥ 1.8
- éªŒè¯ AWS SSO ç™»å½• token æœªè¿‡æœŸ
- æ£€æµ‹ Helm ä»“åº“æ˜¯å¦å°±ç»ªï¼ˆå¦‚ Helm Repo æ›´æ–°ï¼‰
- æ£€æŸ¥ kubectl çš„ kubeconfig æ˜¯å¦æŒ‡å‘ç›®æ ‡é›†ç¾¤

### è„šæœ¬æ¸…å•

| è„šæœ¬å                     | åŠŸèƒ½                                |
| --------------------------| -----------------------------------|
| `preflight.sh`            | é¢„æ£€ AWS CLI å‡­è¯ + Service Quotas  |
| `tf-import.sh`            | å°† EKS é›†ç¾¤èµ„æºå¯¼å…¥ Terraform çŠ¶æ€   |
| `post-recreate.sh`        | åˆ·æ–° kubeconfigï¼Œåº”ç”¨ ALB æ§åˆ¶å™¨ CRDs å¹¶é€šè¿‡ Helm å®‰è£…/å‡çº§ AWS Load Balancer Controllerã€Cluster Autoscalerã€metrics-server å’Œ HPAï¼›éƒ¨ç½²åº”ç”¨ task-apiï¼ˆå¤šæ¸…å• + ECR digestï¼‰ã€å‘å¸ƒ Ingress å¹¶å®Œæˆå†’çƒŸéªŒè¯ï¼Œä»¥åŠè‡ªåŠ¨ä¸ºæœ€æ–° NodeGroup ç»‘å®š Spot é€šçŸ¥ |
| `post-teardown.sh`        | é”€æ¯é›†ç¾¤åæ¸…ç† CloudWatch æ—¥å¿—ç»„å¹¶éªŒè¯æ‰€æœ‰èµ„æºå·²åˆ é™¤ |
| `scale-nodegroup-zero.sh` | å°† EKS é›†ç¾¤æ‰€æœ‰ NodeGroup å®ä¾‹æ•°ç¼©å®¹è‡³ 0ï¼›æš‚åœæ‰€æœ‰å·¥ä½œèŠ‚ç‚¹ä»¥é™ä½ EC2 æˆæœ¬ |
| `update-diagrams.sh`      | å›¾è¡¨ç”Ÿæˆè„šæœ¬ |

- `update-diagrams.sh` è„šæœ¬ä¾èµ–ï¼šéœ€å®‰è£… `Graphviz`
- è„šæœ¬çš„è¿è¡Œæ—¥å¿—é»˜è®¤å†™å…¥ `scripts/logs` ç›®å½•ä¸‹ï¼›æœ€è¿‘ä¸€æ¬¡å·²ç»‘å®šçš„ ASG åç¼“å­˜äº `scripts/.last-asg-bound`ï¼Œä¸¤è€…å‡å·²åœ¨ `.gitignore` æ’é™¤ã€‚

---

## æœªæ¥è®¡åˆ’

Renda Cloud Lab ä»åœ¨æŒç»­æ¼”è¿›ä¸­ï¼Œæœªæ¥è§„åˆ’åŒ…æ‹¬ä½†ä¸é™äºï¼š

- **é›†æˆå®Œæ•´ CI/CD æµæ°´çº¿**ï¼šç»“åˆ `AWS CodePipeline` ç­‰æœåŠ¡ï¼Œå®ç°ä»ä»£ç æäº¤åˆ°å®¹å™¨é•œåƒæ„å»ºã€å®‰å…¨æ‰«æã€éƒ¨ç½²åˆ° EKS çš„ç«¯åˆ°ç«¯è‡ªåŠ¨åŒ–æµæ°´çº¿ï¼Œå¹¶æä¾›ç¤ºä¾‹åº”ç”¨æ¼”ç¤ºæŒç»­äº¤ä»˜è¿‡ç¨‹ã€‚
- **å¢å¼º GitOps ä¸å‘å¸ƒç­–ç•¥**ï¼šåœ¨é›†ç¾¤ä¸­éƒ¨ç½² `Argo CD` ç­‰å·¥å…·ï¼Œæ”¯æŒå¤šç¯å¢ƒï¼ˆDev / Stage / Prodï¼‰çš„ GitOps å·¥ä½œæµã€‚æ¢ç´¢åº”ç”¨åˆ†ç»„ç®¡ç†ã€è“ç»¿éƒ¨ç½²/é‡‘ä¸é›€å‘å¸ƒç­–ç•¥ï¼Œä»¥æé«˜éƒ¨ç½²çš„å¼¹æ€§å’Œå¯é æ€§ã€‚
- **ä¸°å¯Œå¯è§‚æµ‹æ€§ä¸æ··æ²Œå·¥ç¨‹åœºæ™¯**ï¼šå¼•å…¥æ—¥å¿—æ”¶é›†ï¼ˆ`EFK` æˆ– `AWS OpenSearch`ï¼‰ã€åˆ†å¸ƒå¼è¿½è¸ªç­‰ç»„ä»¶å®Œå–„ Observabilityï¼ŒåŒæ—¶å¢åŠ  `Chaos Mesh` æ··æ²Œå®éªŒç¤ºä¾‹ï¼ˆå¦‚èŠ‚ç‚¹æ•…éšœã€ç½‘ç»œå»¶è¿Ÿï¼‰ï¼Œæå‡é›†ç¾¤çš„ç¨³å¥æ€§ã€‚
- **AI Sidecar å®è·µ**ï¼šå¼€å‘å¹¶éƒ¨ç½²ç¤ºä¾‹å¾®æœåŠ¡ï¼Œæ¼”ç¤ºå¦‚ä½•é€šè¿‡ Spring AI å°†å¤§å‹è¯­è¨€æ¨¡å‹é›†æˆåˆ°äº‘åŸç”Ÿåº”ç”¨ä¸­ã€‚ä¾‹å¦‚ï¼ŒåŸºäº `AWS Bedrock` çš„ `Titan` æ¨¡å‹æˆ– `GCP Vertex AI`ï¼Œå®ç°æ™ºèƒ½å®¢æœã€å†…å®¹æ¨èç­‰åœºæ™¯ï¼Œå¹¶æä¾›å‚è€ƒæ¶æ„ã€‚
- **å®‰å…¨ä¸åˆè§„**ï¼šå¢åŠ æ›´å¤šå®‰å…¨æªæ–½å’Œæˆæœ¬æŠ¤æ ï¼Œå¦‚ä½¿ç”¨ `OPA Gatekeeper` ç¼–å†™ç­–ç•¥çº¦æŸ Kubernetes èµ„æºé…ç½®ã€å®šæœŸé•œåƒæ¼æ´æ‰«ææŠ¥å‘Šã€è‡ªåŠ¨åŒ–æˆæœ¬åˆ†æé€šçŸ¥ç­‰ï¼Œå¸®åŠ©ä½¿ç”¨è€…åœ¨å®è·µä¸­æŒæ¡äº‘ä¸Šæ²»ç†æŠ€å·§ã€‚

---

## ğŸ¤ è´¡çŒ®æŒ‡å—

- Fork & clone this repo.
- è¿›å…¥è™šæ‹Ÿç¯å¢ƒï¼š
   ```bash
   # å¦‚æœè¿˜æ²¡å®‰è£…è™šæ‹Ÿç¯å¢ƒï¼Œæ‰§è¡Œå‘½ä»¤ï¼špython -m venv venv
   source venv/bin/activate
   ```
- å®‰è£…ä¾èµ–å¹¶å¯ç”¨ **pre-commit**:
   ```bash
   pip install pre-commit
   pre-commit install
   ```
- åœ¨æ¯æ¬¡æäº¤å‰ï¼Œé’©å­ä¼šè‡ªåŠ¨è¿è¡Œã€‚
- README å’Œ docs ä¸‹çš„æ–‡æ¡£ä¼šè‡ªåŠ¨æ›´æ–° Doctoc ç›®å½•ï¼ˆè‹¥æœ¬åœ°æœªå®‰è£…åˆ™è·³è¿‡ï¼‰ã€‚
- ä½ ä¹Ÿå¯ä»¥æ‰‹åŠ¨è§¦å‘ï¼š
  ```bash
  pre-commit run --all-files
  ```

> âœ… æ‰€æœ‰æäº¤å¿…é¡»é€šè¿‡ pre-commit æ£€æŸ¥ï¼›CI ä¼šé˜»æ­¢ä¸ç¬¦åˆè§„èŒƒçš„ PRã€‚

---

## ğŸ” License

æœ¬é¡¹ç›®ä»¥ **MIT License** å‘å¸ƒï¼Œä½ å¯ä»¥è‡ªç”±ä½¿ç”¨ä¸ä¿®æ”¹ã€‚è¯·åœ¨åˆ†å‘æ—¶ä¿ç•™åŸå§‹è®¸å¯è¯å£°æ˜ã€‚

---

## ğŸ“¬ è”ç³»æ–¹å¼

- è”ç³»äººï¼šå¼ äººå¤§ï¼ˆRenda Zhangï¼‰
- ğŸ“§ é‚®ç®±ï¼š[952402967@qq.com](mailto:952402967@qq.com)

> â° **Maintainer**ï¼š@Renda â€” å¦‚æœæœ¬é¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ä¸è¦å¿˜äº†ç‚¹äº® â­ï¸ Star æ”¯æŒæˆ‘ä»¬ï¼
